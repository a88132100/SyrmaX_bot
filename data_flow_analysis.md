# ç­–ç•¥æ•¸æ“šæµç¨‹åˆ†æ

## ğŸ“Š æ•¸æ“šä¾†æºæ¶æ§‹

### 1. äº¤æ˜“æ‰€æ•¸æ“šå±¤
```
äº¤æ˜“æ‰€ API â†’ äº¤æ˜“æ‰€å®¢æˆ¶ç«¯ â†’ æ•¸æ“šè™•ç† â†’ ç­–ç•¥åˆ†æ
```

#### æ”¯æ´çš„äº¤æ˜“æ‰€
- **Binance** (å¹£å®‰) - å®Œæ•´æ”¯æ´ï¼Œæ¸¬è©¦ç¶²å¯ç”¨
- **Bybit** - å®Œæ•´æ”¯æ´ï¼Œæ¸¬è©¦ç¶²å¯ç”¨  
- **OKX** - å®Œæ•´æ”¯æ´ï¼Œæ¸¬è©¦ç¶²å¯ç”¨
- **BingX** - åŸºç¤æ”¯æ´ï¼ŒCCXTæ•´åˆ
- **Bitget** - åŸºç¤æ”¯æ´ï¼ŒCCXTæ•´åˆ

### 2. æ•¸æ“šé¡å‹

#### Kç·šæ•¸æ“š (OHLCV)
- **æ™‚é–“æˆ³** (timestamp)
- **é–‹ç›¤åƒ¹** (open)
- **æœ€é«˜åƒ¹** (high) 
- **æœ€ä½åƒ¹** (low)
- **æ”¶ç›¤åƒ¹** (close)
- **æˆäº¤é‡** (volume)

#### å¯¦æ™‚æ•¸æ“š
- **ç•¶å‰åƒ¹æ ¼** (ticker)
- **å¸³æˆ¶é¤˜é¡** (balance)
- **æŒå€‰è³‡è¨Š** (positions)
- **æ§“æ¡¿è¨­å®š** (leverage)

## ğŸ”„ æ•¸æ“šè™•ç†æµç¨‹

### æ­¥é©Ÿ1: æ•¸æ“šç²å–
```python
# å¾äº¤æ˜“æ‰€ç²å–Kç·šæ•¸æ“š
def fetch_historical_klines(self, symbol: str, interval: str = '1m', limit: int = 500):
    klines = self.client.fetch_klines(symbol, interval, limit)
    df = pd.DataFrame(klines, columns=['timestamp', 'open', 'high', 'low', 'close', 'volume'])
    return df
```

### æ­¥é©Ÿ2: æ•¸æ“šé è™•ç†
```python
# æ•¸æ“šé¡å‹è½‰æ›å’Œæ¸…ç†
df['timestamp'] = pd.to_datetime(df['timestamp'], unit='ms')
df.set_index('timestamp', inplace=True)

# æ•¸å€¼è½‰æ›
for col in ['open', 'high', 'low', 'close', 'volume']:
    df[col] = pd.to_numeric(df[col])
```

### æ­¥é©Ÿ3: æŠ€è¡“æŒ‡æ¨™è¨ˆç®—
```python
# åŸºç¤æŒ‡æ¨™é è¨ˆç®—
def precompute_indicators(self, df: pd.DataFrame):
    df['ema_5'] = df['close'].ewm(span=5).mean()
    df['ema_20'] = df['close'].ewm(span=20).mean()
    df['rsi'] = talib.RSI(df['close'], timeperiod=14)
    df['macd'], df['macd_signal'], _ = talib.MACD(df['close'])
    df['atr'] = talib.ATR(df['high'], df['low'], df['close'], timeperiod=14)
    return df
```

### æ­¥é©Ÿ4: ç­–ç•¥å°ˆç”¨æŒ‡æ¨™
```python
# æ¿€é€²ç­–ç•¥æŒ‡æ¨™
df['ema_3'] = talib.EMA(df['close'], timeperiod=3)
df['ema_8'] = talib.EMA(df['close'], timeperiod=8)

# å¹³è¡¡ç­–ç•¥æŒ‡æ¨™  
df['rsi'] = talib.RSI(df['close'], timeperiod=10)
df['ma_short'] = df['close'].rolling(5).mean()
df['ma_long'] = df['close'].rolling(20).mean()
df['cci'] = talib.CCI(df['high'], df['low'], df['close'], timeperiod=20)

# ä¿å®ˆç­–ç•¥æŒ‡æ¨™
df['ema_fast'] = talib.EMA(df['close'], timeperiod=50)
df['ema_slow'] = talib.EMA(df['close'], timeperiod=200)
df['adx'] = talib.ADX(df['high'], df['low'], df['close'], timeperiod=14)
df['bb_upper'], df['bb_middle'], df['bb_lower'] = talib.BBANDS(df['close'])
```

## ğŸ“ˆ ç­–ç•¥æ•¸æ“šéœ€æ±‚

### æ¿€é€²ç­–ç•¥çµ„åˆ
| ç­–ç•¥åç¨± | æ‰€éœ€æŒ‡æ¨™ | æ•¸æ“šä¾†æº | è¨ˆç®—æ–¹å¼ |
|---------|---------|---------|---------|
| EMAäº¤å‰ | ema_3, ema_8 | æ”¶ç›¤åƒ¹ | talib.EMA() |
| å¸ƒæ—å¸¶çªç ´ | å¸ƒæ—å¸¶ä¸Šä¸‹è»Œ | æ”¶ç›¤åƒ¹ | talib.BBANDS() |
| VWAPåé›¢ | VWAP, æ”¶ç›¤åƒ¹ | æ”¶ç›¤åƒ¹+æˆäº¤é‡ | ç´¯ç©è¨ˆç®— |
| é‡èƒ½çˆ†é‡ | æˆäº¤é‡å‡å€¼ | æˆäº¤é‡ | rolling.mean() |
| CCIåè½‰ | CCI | é«˜ä½æ”¶ç›¤åƒ¹ | talib.CCI() |

### å¹³è¡¡ç­–ç•¥çµ„åˆ
| ç­–ç•¥åç¨± | æ‰€éœ€æŒ‡æ¨™ | æ•¸æ“šä¾†æº | è¨ˆç®—æ–¹å¼ |
|---------|---------|---------|---------|
| RSIå‡å€¼å›æ­¸ | RSI | æ”¶ç›¤åƒ¹ | talib.RSI() |
| ATRçªç ´ | ATR | é«˜ä½æ”¶ç›¤åƒ¹ | talib.ATR() |
| MAé€šé“ | çŸ­æœŸ/é•·æœŸMA | æ”¶ç›¤åƒ¹ | rolling.mean() |
| æˆäº¤é‡è¶¨å‹¢ | æˆäº¤é‡åºåˆ— | æˆäº¤é‡ | è¶¨å‹¢åˆ†æ |
| CCIä¸­ç·šè¶¨å‹¢ | CCI | é«˜ä½æ”¶ç›¤åƒ¹ | talib.CCI() |

### ä¿å®ˆç­–ç•¥çµ„åˆ
| ç­–ç•¥åç¨± | æ‰€éœ€æŒ‡æ¨™ | æ•¸æ“šä¾†æº | è¨ˆç®—æ–¹å¼ |
|---------|---------|---------|---------|
| é•·æœŸEMAäº¤å‰ | ema_50, ema_200 | æ”¶ç›¤åƒ¹ | talib.EMA() |
| ADXè¶¨å‹¢ | ADX, +DI, -DI | é«˜ä½æ”¶ç›¤åƒ¹ | talib.ADX() |
| å¸ƒæ—å¸¶å‡å€¼å›æ­¸ | å¸ƒæ—å¸¶ä¸Šä¸‹è»Œ | æ”¶ç›¤åƒ¹ | talib.BBANDS() |
| ä¸€ç›®å‡è¡¡è¡¨ | è½‰æ›ç·šã€åŸºæº–ç·šç­‰ | é«˜ä½åƒ¹ | è‡ªå®šç¾©è¨ˆç®— |
| ATRå‡å€¼å›æ­¸ | ATR | é«˜ä½æ”¶ç›¤åƒ¹ | talib.ATR() |

## ğŸ”§ æ•¸æ“šè³ªé‡ä¿è­‰

### 1. æ•¸æ“šå®Œæ•´æ€§æª¢æŸ¥
```python
# æª¢æŸ¥å¿…è¦æ¬„ä½æ˜¯å¦å­˜åœ¨
required = ['ema_5', 'ema_20', 'rsi', 'macd', 'macd_signal', 'atr']
if not all(col in df.columns and not df[col].isna().all() for col in required):
    continue  # è·³éä¸å®Œæ•´çš„æ•¸æ“š
```

### 2. æ•¸æ“šæœ‰æ•ˆæ€§é©—è­‰
```python
# æª¢æŸ¥åƒ¹æ ¼æ•¸æ“šæ˜¯å¦åˆç†
if price is None or price <= 0:
    logging.warning(f"{symbol} ç„¡æ³•ç²å–æœ‰æ•ˆçš„ç•¶å‰åƒ¹æ ¼")
    continue
```

### 3. æ•¸æ“šæ›´æ–°é »ç‡
```python
# æ ¹æ“šå¹£ç¨®è¨­å®šä¸åŒçš„æ›´æ–°é »ç‡
SYMBOL_INTERVAL_SECONDS = {
    "BTCUSDT": 3,    # 3ç§’æ›´æ–°ä¸€æ¬¡
    "ETHUSDT": 3,    # 3ç§’æ›´æ–°ä¸€æ¬¡
    "ADAUSDT": 5,    # 5ç§’æ›´æ–°ä¸€æ¬¡
    "DOTUSDT": 5,    # 5ç§’æ›´æ–°ä¸€æ¬¡
}
```

## ğŸ“Š æ•¸æ“šå­˜å„²å’Œç·©å­˜

### 1. å¯¦æ™‚æ•¸æ“š
- **ç•¶å‰åƒ¹æ ¼**: æ¯æ¬¡ç­–ç•¥åŸ·è¡Œæ™‚ç²å–
- **å¸³æˆ¶é¤˜é¡**: æ¯æ¬¡é–‹å€‰å‰æª¢æŸ¥
- **æŒå€‰ç‹€æ…‹**: å¯¦æ™‚ç›£æ§

### 2. æ­·å²æ•¸æ“š
- **Kç·šæ•¸æ“š**: é è¨­500æ ¹ï¼Œå¯é…ç½®
- **æŠ€è¡“æŒ‡æ¨™**: å¯¦æ™‚è¨ˆç®—ï¼Œä¸å­˜å„²
- **äº¤æ˜“è¨˜éŒ„**: å­˜å„²åˆ°æ•¸æ“šåº«

### 3. é…ç½®æ•¸æ“š
- **ç­–ç•¥åƒæ•¸**: å­˜å„²åœ¨æ•¸æ“šåº«
- **é¢¨æ§è¨­å®š**: å­˜å„²åœ¨æ•¸æ“šåº«
- **äº¤æ˜“æ‰€é…ç½®**: ç’°å¢ƒè®Šæ•¸

## âš ï¸ æ•¸æ“šé¢¨éšªå’Œå°ç­–

### 1. ç¶²çµ¡å»¶é²
- **å°ç­–**: è¨­ç½®è¶…æ™‚æ©Ÿåˆ¶ï¼Œé‡è©¦æ©Ÿåˆ¶
- **ç›£æ§**: è¨˜éŒ„APIéŸ¿æ‡‰æ™‚é–“

### 2. æ•¸æ“šç¼ºå¤±
- **å°ç­–**: è·³éä¸å®Œæ•´çš„æ•¸æ“šï¼Œç­‰å¾…ä¸‹æ¬¡æ›´æ–°
- **ç›£æ§**: è¨˜éŒ„æ•¸æ“šç¼ºå¤±æ¬¡æ•¸

### 3. æ•¸æ“šç•°å¸¸
- **å°ç­–**: åƒ¹æ ¼åˆç†æ€§æª¢æŸ¥ï¼Œç•°å¸¸å€¼éæ¿¾
- **ç›£æ§**: è¨˜éŒ„ç•°å¸¸æ•¸æ“šæƒ…æ³

### 4. äº¤æ˜“æ‰€é™åˆ¶
- **å°ç­–**: è«‹æ±‚é »ç‡æ§åˆ¶ï¼ŒAPIé™é¡ç®¡ç†
- **ç›£æ§**: è¨˜éŒ„APIèª¿ç”¨æ¬¡æ•¸

## ğŸ¯ æ•¸æ“šå„ªåŒ–å»ºè­°

### 1. æŒ‡æ¨™é è¨ˆç®—
- ä¸€æ¬¡æ€§è¨ˆç®—æ‰€æœ‰ç­–ç•¥éœ€è¦çš„æŒ‡æ¨™
- é¿å…é‡è¤‡è¨ˆç®—ç›¸åŒæŒ‡æ¨™

### 2. æ•¸æ“šç·©å­˜
- ç·©å­˜å¸¸ç”¨çš„æŠ€è¡“æŒ‡æ¨™
- æ¸›å°‘é‡è¤‡çš„APIèª¿ç”¨

### 3. æ‰¹é‡è™•ç†
- æ‰¹é‡ç²å–å¤šå€‹äº¤æ˜“å°çš„æ•¸æ“š
- æé«˜æ•¸æ“šç²å–æ•ˆç‡

### 4. ç•°æ­¥è™•ç†
- ç•°æ­¥ç²å–æ•¸æ“šå’ŒåŸ·è¡Œç­–ç•¥
- æé«˜ç³»çµ±éŸ¿æ‡‰é€Ÿåº¦

## ğŸ“‹ ç¸½çµ

ç­–ç•¥ä¸­ä½¿ç”¨çš„æ•¸æ“šä¾†æºå®Œæ•´ä¸”å¯é ï¼š

âœ… **æ•¸æ“šä¾†æº**: æ”¯æ´5å¤§ä¸»æµäº¤æ˜“æ‰€ï¼Œæ•¸æ“šè³ªé‡æœ‰ä¿éšœ  
âœ… **æ•¸æ“šè™•ç†**: å®Œæ•´çš„æ•¸æ“šæ¸…ç†å’ŒæŒ‡æ¨™è¨ˆç®—æµç¨‹  
âœ… **æ•¸æ“šé©—è­‰**: å¤šå±¤æ¬¡æ•¸æ“šæœ‰æ•ˆæ€§æª¢æŸ¥  
âœ… **é¢¨éšªæ§åˆ¶**: å®Œå–„çš„æ•¸æ“šç•°å¸¸è™•ç†æ©Ÿåˆ¶  
âœ… **æ€§èƒ½å„ªåŒ–**: æŒ‡æ¨™é è¨ˆç®—å’Œç·©å­˜æ©Ÿåˆ¶  

æ‰€æœ‰ç­–ç•¥éƒ½èƒ½ç²å¾—æº–ç¢ºã€åŠæ™‚çš„å¸‚å ´æ•¸æ“šï¼Œç¢ºä¿äº¤æ˜“æ±ºç­–çš„å¯é æ€§ï¼
